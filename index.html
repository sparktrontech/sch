<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart School Bell Panel</title>

<style>
body{
font-family:Segoe UI;
margin:0;
background:
linear-gradient(rgba(0,0,0,0.6),rgba(0,0,0,0.6)),
url("background.jpg");
background-size:cover;
background-attachment:fixed;
color:white;
}

/* HEADER */
header{
background:rgba(0,0,0,0.8);
padding:15px 20px;
display:flex;
justify-content:space-between;
align-items:center;
flex-wrap:wrap;
}

.logoSection{
display:flex;
align-items:center;
}

.logoSection img{
height:70px;
margin-right:15px;
}

.schoolName{
font-size:22px;
font-weight:bold;
}

.statusClockBox{
display:flex;
flex-direction:column;
align-items:flex-end;
}

#clock{
font-size:26px;
font-weight:bold;
}

#date{
font-size:14px;
}

#espStatus{
margin-top:5px;
padding:6px 12px;
border-radius:20px;
font-size:13px;
font-weight:bold;
background:gray;
}

/* CONTAINER */
.container{
width:95%;
margin:auto;
margin-top:20px;
}

.card{
background:rgba(255,255,255,0.95);
color:black;
padding:20px;
border-radius:10px;
box-shadow:0 4px 12px rgba(0,0,0,0.4);
margin-bottom:20px;
}

input,select{
padding:8px;
margin:5px;
border-radius:6px;
border:1px solid #ccc;
}

button{
padding:8px 15px;
border:none;
border-radius:6px;
cursor:pointer;
margin:3px;
}

.addBtn{ background:#27ae60; color:white; }
.deleteBtn{ background:#e74c3c; color:white; }

table{
width:100%;
border-collapse:collapse;
margin-top:10px;
}

th,td{
border:1px solid #ccc;
padding:8px;
text-align:center;
}

.hidden{ display:none; }

footer{
position:fixed;
bottom:10px;
right:10px;
background:#1e3d59;
color:white;
padding:10px 15px;
border-radius:8px;
font-size:13px;
box-shadow:0 3px 8px rgba(0,0,0,0.5);
}

@media(max-width:600px){
input,select{ width:100%; }
header{ flex-direction:column; align-items:flex-start; }
.statusClockBox{ align-items:flex-start; margin-top:10px; }
}
</style>
</head>

<body>

<header>
<div class="logoSection">
<img src="logo.png">
<div class="schoolName">
Sparktron Smart Bell
</div>
</div>

<div class="statusClockBox">
<div id="clock"></div>
<div id="date"></div>
<div id="espStatus">Checking ESP...</div>
</div>
</header>

<div class="container">

<div class="card" id="loginBox">
<h3>Admin Login</h3>
<input type="text" id="username" placeholder="Username"><br>
<input type="password" id="password" placeholder="Password"><br>
<button onclick="login()">Login</button>
</div>

<div class="card hidden" id="dashboard">

<h3>Add Bell Schedule</h3>

<select id="day">
<option>Monday</option>
<option>Tuesday</option>
<option>Wednesday</option>
<option>Thursday</option>
<option>Friday</option>
<option>Saturday</option>
<option>Sunday</option>
</select>

<input type="number" id="hour" min="0" max="23" placeholder="Hour">
<input type="number" id="minute" min="0" max="59" placeholder="Minute">
<input type="number" id="duration" placeholder="Duration (sec)">

<br>

<label><input type="checkbox" id="repeatNext"> Repeat Next Day</label>
<label><input type="checkbox" id="repeatWeek"> Repeat Full Week</label>

<br>
<button class="addBtn" onclick="addSchedule()">Upload Schedule</button>

<h3>Weekly Time Table</h3>

<table id="table">
<tr>
<th>Day</th>
<th>Time</th>
<th>Duration</th>
<th>Action</th>
</tr>
</table>

</div>
</div>

<footer>
Developed by Vishwajeet Jadhav <br>
ðŸ“ž9322244959 <br>
ðŸ“§jadhavvishwajeet94@gmail.com
</footer>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<script>

/* ðŸ”¥ YOUR FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyCkl4p4SnS84EzLIyIjTk5euJH9lx9FVSI",
  authDomain: "sparktrontechbell.firebaseapp.com",
  databaseURL: "https://sparktrontechbell-default-rtdb.firebaseio.com",
  projectId: "sparktrontechbell",
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

/* CLOCK */
function updateClock(){
const now = new Date();
document.getElementById("clock").innerText =
String(now.getHours()).padStart(2,'0') + ":" +
String(now.getMinutes()).padStart(2,'0') + ":" +
String(now.getSeconds()).padStart(2,'0');

document.getElementById("date").innerText =
now.toLocaleDateString('en-IN',{
weekday:'long',
year:'numeric',
month:'long',
day:'numeric'
});
}
setInterval(updateClock,1000);
updateClock();

/* LOGIN */
function login(){
if(username.value==="srjadhav" && password.value==="7588"){
loginBox.classList.add("hidden");
dashboard.classList.remove("hidden");
}else{
alert("Wrong login");
}
}

/* ESP STATUS */
database.ref("/SchoolBell/espStatus").on("value",(snapshot)=>{
const lastUpdate=snapshot.val();
if(!lastUpdate) return;
const diff=Date.now()-lastUpdate;
if(diff<15000){
espStatus.style.background="green";
espStatus.innerText="ðŸŸ¢ ESP32 ONLINE";
}else{
espStatus.style.background="red";
espStatus.innerText="ðŸ”´ ESP32 OFFLINE";
}
});

/* LOAD TABLE DAY-WISE & TIME SORTED */
database.ref("/SchoolBell/schedule").on("value",(snapshot)=>{

let table=document.getElementById("table");
table.innerHTML="<tr><th>Day</th><th>Time (24H)</th><th>Duration</th><th>Action</th></tr>";

let dataArray=[];

snapshot.forEach((child)=>{
let data=child.val();
data.key=child.key;
dataArray.push(data);
});

/* DAY ORDER */
const dayOrder={
"Monday":1,
"Tuesday":2,
"Wednesday":3,
"Thursday":4,
"Friday":5,
"Saturday":6,
"Sunday":7
};

/* SORTING */
dataArray.sort((a,b)=>{

if(dayOrder[a.day] !== dayOrder[b.day]){
return dayOrder[a.day] - dayOrder[b.day];
}

/* If same day â†’ sort by hour */
if(a.hour !== b.hour){
return a.hour - b.hour;
}

/* If same hour â†’ sort by minute */
return a.minute - b.minute;

});

/* DISPLAY SORTED DATA */
dataArray.forEach((data)=>{

let row=table.insertRow(-1);

row.insertCell(0).innerHTML=data.day;

row.insertCell(1).innerHTML=
String(data.hour).padStart(2,'0')+":"+
String(data.minute).padStart(2,'0');

row.insertCell(2).innerHTML=data.duration+" sec";

row.insertCell(3).innerHTML=
"<button class='deleteBtn' onclick=\"deleteSchedule('"+data.key+"')\">Delete</button>";

});

});


/* ADD SCHEDULE */
const days=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];

function addSchedule(){

let day=document.getElementById("day").value;
let hour=document.getElementById("hour").value;
let minute=document.getElementById("minute").value;
let duration=document.getElementById("duration").value;
let repeatNext=document.getElementById("repeatNext").checked;
let repeatWeek=document.getElementById("repeatWeek").checked;

if(hour===""||minute===""||duration===""){
alert("Fill all fields");
return;
}

if(repeatWeek){
days.forEach(d=>{
database.ref("/SchoolBell/schedule").push({
day:d,
hour:parseInt(hour),
minute:parseInt(minute),
duration:parseInt(duration)
});
});
}else{
database.ref("/SchoolBell/schedule").push({
day:day,
hour:parseInt(hour),
minute:parseInt(minute),
duration:parseInt(duration)
});

if(repeatNext){
let index=days.indexOf(day);
if(index<6){
database.ref("/SchoolBell/schedule").push({
day:days[index+1],
hour:parseInt(hour),
minute:parseInt(minute),
duration:parseInt(duration)
});
}
}
}

alert("Schedule Uploaded Successfully âœ…");
}

/* DELETE */
function deleteSchedule(key){
database.ref("/SchoolBell/schedule/"+key).remove();
}

</script>

</body>
</html>




